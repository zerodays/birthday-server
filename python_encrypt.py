p = 167647602464448277878177195587687950691602343814695180201126682097151290758285004892633689448831383831068680442293393811427267720590046823745589824657547766362072351020914298242099400995956478854177547360048804797463364777634772925637300122899338429448117027349099371336026881590844736560567326807001173454971
q = 164010474660458827578722990972572376827501015591960120327164648581410965824465938279699295376072046416432082254095006022868932306118424393142843684716352463132701601523161021901085827176526925793585159466923596723188853912268100227413856927462669629894911025627181169548822208032093557947175230572122256719479

n = p * q

e = 65537
d = pow(e, -1, (p-1) * (q-1))


m = 'https://www.mimovrste.com/sledenje-narocila/detail/125699076/1'

# encoding message to int
x = int.from_bytes(m.encode("utf-8"), byteorder='big')

# encrypt
encrypted = pow(x, e, n)

# encrypt to hex
encrypted_hex = encrypted.to_bytes((encrypted.bit_length() + 7) // 8, byteorder='big').hex()
print(encrypted_hex)

# hex to int
encrypted = int.from_bytes(bytes.fromhex(encrypted_hex), byteorder='big')

# decrypt
decrypted = pow(encrypted, d, n)

# decode decrypted to string
decrypted_str = decrypted.to_bytes((decrypted.bit_length() + 7) // 8, byteorder='big').decode("utf-8")
print(decrypted_str)
